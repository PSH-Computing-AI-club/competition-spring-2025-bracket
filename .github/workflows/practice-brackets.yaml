name: Practice Brackets

on:
    push:
        branches: [main]

env:
    TIMEZONE: 'America/New_York'
    DATE_START: '2025-01-01'
    DATE_END: '2025-01-31'

jobs:
    check-date:
        runs-on: ubuntu-22.04

        steps:
            - name: Clone Repository
              uses: actions/checkout@v4

            - name: Configure Deno
              uses: denoland/setup-deno@v2
              with:
                  deno-version: 2.1.4

            - name: Is Practice Bracket Date Range
              id: date-check
              run: deno task workflow:date-check $TIMEZONE $DATE_START $DATE_END

    run-bracket:
        needs: check-date

        runs-on: ubuntu-22.04

        steps:
            - name: Clone Repository
              uses: actions/checkout@v4

            - name: Configure Deno
              uses: denoland/setup-deno@v2
              with:
                  deno-version: 2.1.4

            - name: Clone Competitor Repositories
              run: deno task bracket:clone

            - name: Run Bracket
              run: deno task bracket:run

            - name: Visualize Bracket
              run: deno task bracket:visualize
